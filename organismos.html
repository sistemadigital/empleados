<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Organismos</title>
  
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>
  
  <style>
    /* Variables CSS */
    :root {
        --primary-blue: #007bff;
        --primary-light-blue: #e7f4ff;
        --primary-dark-blue: #0056b3;
        --secondary-gray: #f8f9fa;
        --secondary-light-gray: #e9ecef;
        --secondary-dark-gray: #6c757d;
        --status-success: #28a745;
        --status-warning: #ffc107;
        --status-danger: #dc3545;
        --status-info: #17a2b8;
        --text-primary: #212529;
        --text-secondary: #6c757d;
        --text-link: #007bff;
        --text-light: #ffffff;
        --background-default: #ffffff;
        --background-card: #ffffff;
        --background-header: #ffffff;
        --background-table-header: #f8f9fa;
        --border-default: #dee2e6;
        --font-family: 'Arial', 'Helvetica', sans-serif;
        --display-size: 24px;
        --h1-size: 20px;
        --h2-size: 18px;
        --body-large-size: 16px;
        --body-regular-size: 14px;
        --caption-size: 12px;
        --font-weight-regular: 400;
        --font-weight-semibold: 600;
        --font-weight-bold: 700;
        --spacing-unit: 8px;
        --spacing-xs: 4px;
        --spacing-s: 8px;
        --spacing-m: 16px;
        --spacing-l: 24px;
        --spacing-xl: 32px;
        --spacing-gutter: 20px;
        --border-radius-small: 2px;
        --border-radius-default: 4px;
        --border-radius-pill: 20px;
        --shadow-none: none;
        --shadow-subtle: 0 1px 3px rgba(0,0,0,0.1);
        --radius: 12px;
        --shadow: 0 4px 15px rgba(0,0,0,.08);
    }

    /* Estilos base */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: var(--font-family);
        background-color: var(--background-default);
        color: var(--text-primary);
        line-height: 1.5;
        min-height: 100vh;
    }

    /* Header */
    .header {
        background-color: var(--background-header);
        border-bottom: 1px solid var(--border-default);
        padding: var(--spacing-s) var(--spacing-m);
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: var(--shadow-subtle);
    }

    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: 1200px;
        margin: 0 auto;
    }

    .logo {
        font-size: var(--h1-size);
        font-weight: var(--font-weight-bold);
        color: var(--primary-blue);
    }

    .header-buttons {
        display: flex;
        gap: var(--spacing-s);
    }

    /* Contenedor principal */
    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: var(--spacing-m) var(--spacing-gutter);
    }

    /* M贸dulos de categor铆as */
    .modules-section {
        margin-bottom: var(--spacing-xl);
    }

    .modules-title {
        font-size: var(--h2-size);
        font-weight: var(--font-weight-semibold);
        margin-bottom: var(--spacing-m);
        text-align: center;
    }

    .modules-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--spacing-m);
        margin-bottom: var(--spacing-l);
    }

    .module-card {
        background: var(--background-card);
        border: 1px solid var(--border-default);
        border-radius: var(--border-radius-default);
        padding: var(--spacing-l);
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-subtle);
    }

    .module-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow);
        border-color: var(--primary-blue);
    }

    .module-card.active {
        background-color: var(--primary-light-blue);
        border-color: var(--primary-blue);
    }

    .module-icon {
        font-size: 2rem;
        color: var(--primary-blue);
        margin-bottom: var(--spacing-s);
    }

    .module-name {
        font-weight: var(--font-weight-semibold);
        margin-bottom: var(--spacing-xs);
    }

    .module-count {
        font-size: var(--caption-size);
        color: var(--text-secondary);
    }

    /* Filtros */
    .filters-section {
        background-color: var(--background-card);
        padding: var(--spacing-m);
        border-radius: var(--border-radius-default);
        border: 1px solid var(--border-default);
        margin-bottom: var(--spacing-xl);
        box-shadow: var(--shadow-subtle);
        display: none;
    }

    .filters-title {
        font-size: var(--h2-size);
        font-weight: var(--font-weight-semibold);
        margin-bottom: var(--spacing-m);
    }

    .filter-row {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-m);
    }

    .filter-group {
        flex: 1;
        min-width: 200px;
    }

    .filter-label {
        display: block;
        font-size: var(--body-regular-size);
        margin-bottom: var(--spacing-xs);
        font-weight: var(--font-weight-semibold);
    }

    .input, .dropdown {
        border: 1px solid var(--border-default);
        border-radius: var(--border-radius-default);
        padding: var(--spacing-s);
        background-color: var(--background-default);
        color: var(--text-primary);
        font-size: var(--body-regular-size);
        width: 100%;
        transition: border-color 0.2s;
    }

    .input:focus, .dropdown:focus {
        outline: none;
        border-color: var(--primary-blue);
    }

    /* Botones de acci贸n */
    .action-buttons {
        display: flex;
        gap: var(--spacing-s);
        margin-top: var(--spacing-m);
        flex-wrap: wrap;
    }

    .button {
        background-color: var(--primary-blue);
        color: var(--text-light);
        border: none;
        border-radius: var(--border-radius-default);
        padding: var(--spacing-s) var(--spacing-m);
        font-size: var(--body-regular-size);
        cursor: pointer;
        transition: background-color 0.2s;
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-xs);
    }

    .button:hover {
        opacity: 0.9;
    }

    .button-success {
        background-color: #1e7e34;
    }

    .button-secondary {
        background-color: var(--secondary-dark-gray);
    }

    .button-warning {
        background-color: var(--status-warning);
        color: var(--text-primary);
    }

    /* Botones peque帽os para iconos */
    .btn-icon {
        padding: 8px;
        width: 36px;
        height: 36px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: none;
        border-radius: var(--border-radius-default);
        cursor: pointer;
        transition: all 0.2s;
        font-size: 14px;
    }

    .btn-icon:hover {
        transform: scale(1.1);
    }

    .btn-view {
        background-color: var(--status-info);
        color: white;
    }

    .btn-edit {
        background-color: var(--status-warning);
        color: white;
    }

    .btn-print {
        background-color: var(--status-success);
        color: white;
    }

    /* Tabla de datos - Estilo moderno */
    .table-section {
        background-color: var(--background-card);
        border-radius: var(--border-radius-default);
        border: 1px solid var(--border-default);
        overflow: hidden;
        box-shadow: var(--shadow-subtle);
        margin-bottom: var(--spacing-m);
        display: none;
    }

    .table-title {
        font-size: var(--h2-size);
        font-weight: var(--font-weight-semibold);
        padding: var(--spacing-m);
        background-color: var(--background-table-header);
        border-bottom: 1px solid var(--border-default);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .table-wrap {
        overflow-x: auto;
    }

    .data-table {
        width: 100%;
        border-collapse: collapse;
        min-width: 800px;
    }

    .data-table th {
        background-color: var(--primary-blue);
        color: var(--text-light);
        font-weight: var(--font-weight-bold);
        padding: var(--spacing-m);
        font-size: var(--caption-size);
        text-transform: uppercase;
        text-align: left;
        position: sticky;
        top: 0;
    }

    .data-table td {
        border-bottom: 1px solid var(--border-default);
        padding: var(--spacing-m);
        color: var(--text-primary);
        font-size: var(--body-regular-size);
        transition: background-color 0.2s;
        font-weight: var(--font-weight-semibold);
    }

    .data-table tr:last-child td {
        border-bottom: none;
    }

    .data-table tr:hover td {
        background-color: var(--primary-light-blue);
    }

    .data-table tr:nth-child(even) {
        background-color: var(--secondary-gray);
    }

    .data-table tr:nth-child(even):hover td {
        background-color: var(--primary-light-blue);
    }

    .actions {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
    }

    /* Paginaci贸n */
    .pagination-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--spacing-m);
        margin-top: var(--spacing-m);
        background: var(--background-card);
        border-radius: var(--border-radius-default);
        box-shadow: var(--shadow-subtle);
        display: none;
    }

    .pagination-container .page-info {
        font-size: var(--body-regular-size);
        color: var(--text-secondary);
        font-weight: var(--font-weight-semibold);
    }

    .pagination-container .nav-buttons {
        display: flex;
        gap: var(--spacing-s);
    }

    .pagination-selector {
        display: flex;
        align-items: center;
        gap: var(--spacing-s);
    }

    .pagination-selector select {
        padding: var(--spacing-s);
        border-radius: var(--border-radius-default);
        border: 1px solid var(--border-default);
    }

    /* MODALES */
    #organismModal, #policiaModal, #viewModal {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,.6);
        justify-content: center;
        align-items: center;
        padding: 20px;
        z-index: 1000;
    }
    
    #organismModal .content, #policiaModal .content, #viewModal .content {
        background: #fff;
        border-radius: 16px;
        max-width: 600px;
        width: 100%;
        max-height: 90vh;
        display: flex;
        flex-direction: column;
        box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        animation: fadeIn .25s ease;
    }
    
    #policiaModal .content {
        max-width: 95%;
        max-height: 95vh;
        width: 95%;
        height: 95vh;
    }
    
    #policiaModal iframe {
        width: 100%;
        height: 100%;
        border: none;
        border-radius: 0 0 16px 16px;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .modal-header {
        position: sticky;
        top: 0;
        background: var(--primary-blue);
        color: #fff;
        padding: 12px 16px;
        font-size: 1.1rem;
        font-weight: 600;
        border-radius: 16px 16px 0 0;
        z-index: 5;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .modal-body {
        padding: 16px;
        overflow-y: auto;
        flex: 1;
    }
    
    #policiaModal .modal-body {
        padding: 0;
        flex: 1;
        display: flex;
    }
    
    .controls-form {
        position: sticky;
        bottom: 0;
        background: #fff;
        padding: 12px 16px;
        border-top: 1px solid #eee;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: flex-end;
        z-index: 5;
    }

    .form-group {
        margin-bottom: 15px;
    }
    
    .form-group label {
        font-weight: 600;
        color: var(--primary-blue);
        font-size: 0.9rem;
        margin-bottom: 4px;
        display: block;
    }
    
    .form-group input, .form-group select, .form-group textarea {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #ddd;
        border-radius: 10px;
        font-size: 0.9rem;
        background: #fafafa;
        transition: .2s;
    }
    
    .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
        outline: none;
        border-color: var(--primary-blue);
        background: #fff;
    }
    
    .field.error input,
    .field.error textarea,
    .field.error select {
        border-color: var(--status-danger);
        background-color: #ffeef0;
    }
    
    .field .error-message {
        color: var(--status-danger);
        font-size: 0.8rem;
        margin-top: 4px;
        display: none;
    }
    
    .field.error .error-message {
        display: block;
    }

    /* Vista de solo lectura */
    .view-field {
        margin-bottom: 15px;
        padding: 10px 0;
        border-bottom: 1px solid #eee;
    }
    
    .view-field label {
        font-weight: 600;
        color: var(--primary-blue);
        font-size: 0.9rem;
        margin-bottom: 4px;
        display: block;
    }
    
    .view-field .value {
        font-size: 1rem;
        color: var(--text-primary);
        padding: 8px 0;
        font-weight: var(--font-weight-semibold);
    }

    /* ALERTA FLOTANTE */
    .floating-alert {
        position: fixed;
        top: -100px;
        left: 50%;
        transform: translateX(-50%);
        background-color: var(--status-danger);
        color: #fff;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        max-width: 400px;
        text-align: center;
        font-size: 1rem;
    }
    
    .floating-alert.success {
        background-color: var(--status-success);
    }

    .floating-alert.show {
        opacity: 1;
        visibility: visible;
        top: 20px;
    }

    /* Estados vac铆os */
    .empty-state {
        padding: 20px;
        text-align: center;
        font-weight: bold;
        color: var(--text-secondary);
        background: var(--secondary-light-gray);
        border-radius: 6px;
        margin: 10px 0;
    }

    /* Responsive */
    @media (max-width: 1024px) {
        .container {
            max-width: 100%;
            padding: var(--spacing-s);
        }
        
        .modules-grid {
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        }
        
        .filter-row {
            gap: var(--spacing-s);
        }
        
        .filter-group {
            min-width: 180px;
        }

        #organismModal .content, #policiaModal .content, #viewModal .content {
            max-width: 95%;
        }
    }

    @media (max-width: 768px) {
        .header-content {
            flex-direction: column;
            gap: var(--spacing-s);
            text-align: center;
        }
        
        .header-buttons {
            flex-direction: column;
            width: 100%;
        }
        
        .header-buttons .button {
            width: 100%;
            justify-content: center;
        }
        
        .modules-grid {
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }
        
        .filter-row {
            flex-direction: column;
        }
        
        .filter-group {
            min-width: auto;
        }
        
        .action-buttons {
            flex-direction: column;
        }

        .controls-form {
            flex-direction: column;
        }
        
        .pagination-container {
            flex-direction: column;
            gap: var(--spacing-m);
            text-align: center;
        }
    }

    @media (max-width: 576px) {
        .container {
            padding: var(--spacing-xs);
        }
        
        .modules-grid {
            grid-template-columns: 1fr 1fr;
        }
        
        .module-card {
            padding: var(--spacing-m);
        }
        
        .filters-section,
        .table-section {
            padding: var(--spacing-s);
        }
        
        .filters-title,
        .table-title {
            font-size: var(--body-large-size);
        }

        #organismModal .content, #policiaModal .content, #viewModal .content {
            max-width: 100%;
            max-height: 100vh;
            border-radius: 0;
        }

        .modal-header,
        .modal-body,
        .controls-form {
            padding: var(--spacing-s);
        }
        
        .actions {
            flex-direction: column;
        }
        
        .data-table {
            min-width: 600px;
        }
    }
  </style>
</head>
<body>
    <!-- Alerta flotante -->
    <div class="floating-alert" id="floating-alert"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">Directorio de Organismos</div>
            <div class="header-buttons">
                <button id="btnPolicia" class="button">
                    <i class="fas fa-shield-alt"></i> Policia de Misiones
                </button>
                <button id="btnNuevo" class="button">
                    <i class="fas fa-plus"></i> Nuevo Organismo
                </button>
            </div>
        </div>
    </header>

    <!-- Contenido principal -->
    <main class="container">
        <!-- M贸dulos de categor铆as -->
        <section class="modules-section">
            <h2 class="modules-title">Selecciona una categor铆a</h2>
            <div class="modules-grid" id="modulesGrid">
                <!-- Los m贸dulos se generar谩n din谩micamente -->
            </div>
        </section>

        <!-- Filtros -->
        <section class="filters-section" id="filtersSection">
            <h2 class="filters-title">Filtros de B煤squeda</h2>
            <div class="filter-row">
                <div class="filter-group">
                    <label class="filter-label" for="buscador">B煤squeda</label>
                    <input type="text" id="buscador" class="input" placeholder=" Buscar...">
                </div>
                <div class="filter-group">
                    <label class="filter-label" for="filtroTipo">Tipo de Organismo</label>
                    <select id="filtroTipo" class="dropdown">
                        <option value="">Tipo (todos)</option>
                        <option>Hospital</option>
                        <option>Ministerio</option>
                        <option>Centro Asistencial</option>
                        <option>Unidad de Traslado</option>
                        <option>Direcci贸n Gubernamental</option>
                        <option>Fundaci贸n</option>
                        <option>Juzgado</option>
                        <option>Municipalidad</option>
                        <option>Otro</option>
                    </select>
                </div>
            </div>
            
            <!-- Botones de impresi贸n -->
            <div class="action-buttons">
                <button id="btnPrintModule" class="button button-success">
                    <i class="fas fa-print"></i> Imprimir M贸dulo
                </button>
                <button id="btnPrintListado" class="button button-success">
                    <i class="fas fa-print"></i> Imprimir Listado
                </button>
            </div>
        </section>

        <!-- Controles de paginaci贸n superiores -->
        <div id="paginacion-superior" class="pagination-container">
            <div class="page-info" id="pageInfoTop">Mostrando 0 de 0 registros</div>
            <div class="pagination-selector">
                <div class="nav-buttons">
                    <button id="btnPrevPageTop" class="button" disabled>
                        <i class="fas fa-chevron-left"></i> Anterior
                    </button>
                    <button id="btnNextPageTop" class="button" disabled>
                        Siguiente <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <select id="pageSelectTop" class="dropdown">
                    <option value="1">P谩gina 1</option>
                </select>
            </div>
        </div>

        <!-- Tabla de datos -->
        <section class="table-section" id="tableSection">
            <div class="table-title">
                <span id="tableCategory">Organismos</span>
                <span id="tableCount">Total: 0</span>
            </div>
            <div class="table-wrap">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Tipo</th>
                            <th>Email</th>
                            <th>Tel茅fono</th>
                            <th>Contacto</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="organismsTableBody">
                        <tr>
                            <td colspan="6">Selecciona una categor铆a para ver los organismos</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Controles de paginaci贸n inferiores -->
        <div id="paginacion-inferior" class="pagination-container">
            <div class="page-info" id="pageInfoBottom">Mostrando 0 de 0 registros</div>
            <div class="pagination-selector">
                <div class="nav-buttons">
                    <button id="btnPrevPageBottom" class="button" disabled>
                        <i class="fas fa-chevron-left"></i> Anterior
                    </button>
                    <button id="btnNextPageBottom" class="button" disabled>
                        Siguiente <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <select id="pageSelectBottom" class="dropdown">
                    <option value="1">P谩gina 1</option>
                </select>
            </div>
        </div>
    </main>

    <!-- Modal para nuevo/editar organismo -->
    <div id="organismModal">
        <div class="content">
            <div class="modal-header">
                <i class="fa-solid fa-building"></i>
                <h2 id="modalTitle" style="margin:0;">Nuevo Organismo</h2>
            </div>
            <div class="modal-body">
                <form id="organismForm" action="#" method="post" aria-label="Formulario para nuevo organismo o edici贸n">
                    <div class="form-group">
                        <label for="nombre">Nombre *</label>
                        <input id="nombre" required autocomplete="off" />
                        <span class="error-message">Este campo es obligatorio.</span>
                    </div>
                    <div class="form-group">
                        <label for="tipo">Tipo *</label>
                        <select id="tipo" required>
                            <option value="">Seleccionar...</option>
                            <option>Hospital</option>
                            <option>Ministerio</option>
                            <option>Centro Asistencial</option>
                            <option>Unidad de Traslado</option>
                            <option>Direcci贸n Gubernamental</option>
                            <option>Fundaci贸n</option>
                            <option>Juzgado</option>
                            <option>Municipalidad</option>
                            <option>Otro</option>
                        </select>
                        <span class="error-message">Este campo es obligatorio.</span>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input id="email" type="email" />
                    </div>
                    <div class="form-group">
                        <label for="telefono">Tel茅fono</label>
                        <input id="telefono" />
                    </div>
                    <div class="form-group">
                        <label for="contacto">Contacto</label>
                        <input id="contacto" />
                    </div>
                    <div class="form-group">
                        <label for="notas">Notas</label>
                        <textarea id="notas" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="controls-form">
                <button class="button button-success" type="button" id="btnGuardar">
                    <i class="fa fa-save"></i> Guardar
                </button>
                <button class="button button-secondary" type="button" id="btnCancelar">
                    <i class="fa fa-xmark"></i> Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para ver organismo -->
    <div id="viewModal">
        <div class="content">
            <div class="modal-header">
                <i class="fa-solid fa-eye"></i>
                <h2 id="viewModalTitle" style="margin:0;">Ver Organismo</h2>
            </div>
            <div class="modal-body">
                <div class="view-field">
                    <label>Nombre</label>
                    <div class="value" id="viewNombre"></div>
                </div>
                <div class="view-field">
                    <label>Tipo</label>
                    <div class="value" id="viewTipo"></div>
                </div>
                <div class="view-field">
                    <label>Email</label>
                    <div class="value" id="viewEmail"></div>
                </div>
                <div class="view-field">
                    <label>Tel茅fono</label>
                    <div class="value" id="viewTelefono"></div>
                </div>
                <div class="view-field">
                    <label>Contacto</label>
                    <div class="value" id="viewContacto"></div>
                </div>
                <div class="view-field">
                    <label>Notas</label>
                    <div class="value" id="viewNotas"></div>
                </div>
            </div>
            <div class="controls-form">
                <button class="button button-warning" type="button" id="btnPrintIndividual">
                    <i class="fas fa-print"></i> Imprimir
                </button>
                <button class="button button-secondary" type="button" id="btnCerrarView">
                    <i class="fa fa-xmark"></i> Cerrar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para Policia de Misiones -->
    <div id="policiaModal">
        <div class="content">
            <div class="modal-header">
                <i class="fas fa-shield-alt"></i>
                <h2 style="margin:0;">Policia de Misiones</h2>
            </div>
            <div class="modal-body">
                <iframe src="https://sistemadigital.github.io/defensor-secretarios/policia.html" 
                        title="Policia de Misiones"></iframe>
            </div>
            <div class="controls-form">
                <button class="button button-secondary" type="button" id="btnCerrarPolicia">
                    <i class="fa fa-xmark"></i> Cerrar
                </button>
            </div>
        </div>
    </div>

    <script>
        // ===== Configuraci贸n de Firebase =====
        const firebaseConfig = {
            apiKey: "AIzaSyCpPdY984mCYWQodeqA6ZVXFxedalExc34",
            authDomain: "repositorio-documentos.firebaseapp.com",
            databaseURL: "https://repositorio-documentos-default-rtdb.firebaseio.com",
            projectId: "repositorio-documentos",
            storageBucket: "repositorio-documentos.firebasestorage.app",
            messagingSenderId: "359488594361",
            appId: "1:359488594361:web:421264bbc3c5f8f7c01668"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const organismsRef = db.ref('organismos');

        // ===== Helpers UI =====
        const $ = (id) => document.getElementById(id);
        const tbody = $("organismsTableBody");
        const modal = $("organismModal");
        const viewModal = $("viewModal");
        const policiaModal = $("policiaModal");
        const modalTitle = $("modalTitle");
        const buscador = $("buscador");
        const filtroTipo = $("filtroTipo");
        const floatingAlert = $("floating-alert");
        const tableCount = $("tableCount");
        const tableCategory = $("tableCategory");
        const filtersSection = $("filtersSection");
        const tableSection = $("tableSection");
        const modulesGrid = $("modulesGrid");

        // ===== Variables de estado =====
        let editingId = null;
        let viewingId = null;
        let allOrganisms = [];
        let filteredOrganisms = [];
        let currentCategory = null;
        let paginaActual = 1;
        const registrosPorPagina = 10;

        // Categor铆as disponibles
        const categories = [
            { id: 'hospital', name: 'Hospital', icon: 'fa-hospital', color: '#dc3545' },
            { id: 'ministerio', name: 'Ministerio', icon: 'fa-landmark', color: '#28a745' },
            { id: 'centro-asistencial', name: 'Centro Asistencial', icon: 'fa-clinic-medical', color: '#17a2b8' },
            { id: 'unidad-traslado', name: 'Unidad de Traslado', icon: 'fa-ambulance', color: '#ffc107' },
            { id: 'direccion-gubernamental', name: 'Direcci贸n Gubernamental', icon: 'fa-building', color: '#6f42c1' },
            { id: 'fundacion', name: 'Fundaci贸n', icon: 'fa-hands-helping', color: '#e83e8c' },
            { id: 'juzgado', name: 'Juzgado', icon: 'fa-gavel', color: '#fd7e14' },
            { id: 'municipalidad', name: 'Municipalidad', icon: 'fa-university', color: '#20c997' },
            { id: 'otros', name: 'Otros', icon: 'fa-ellipsis-h', color: '#6c757d' },
            { id: 'todos', name: 'Todos los Organismos', icon: 'fa-list', color: '#007bff' }
        ];

        // Organismos iniciales para precarga
        const initialOrganisms = [
            {nombre:"Hospital Barreyro",tipo:"Hospital",email:"hospitaldepediatriabarreyro@gmail.com",telefono:"",contacto:"",notas:""},
            {nombre:"Hospital Carrillo",tipo:"Hospital",email:"hospitalsaludmentalcarrillo@gmail.com",telefono:"",contacto:"",notas:""},
            {nombre:"Ministerio de Salud P煤blica de Misiones",tipo:"Ministerio",email:"juridicomspmisiones@gmail.com",telefono:"",contacto:"",notas:"Para compartir oficios dirigidos a cualquier Hospital"},
            {nombre:"Centro Asistencial",tipo:"Centro Asistencial",email:"",telefono:"+5493755636878",contacto:"Jordana Duarte Martinelli",notas:"Encargada de recibir oficios"},
            {nombre:"Unidad Central de Traslado",tipo:"Unidad de Traslado",email:"mps-uct@hotmail.com",telefono:"",contacto:"",notas:""},
            {nombre:"Direcci贸n de Asuntos de Familia",tipo:"Direcci贸n Gubernamental",email:"",telefono:"+5493764856048",contacto:"",notas:""},
            {nombre:"Fundaci贸n Reto a la vida",tipo:"Fundaci贸n",email:"retomisiones@gmail.com",telefono:"",contacto:"",notas:""},
            {nombre:"Juzgado de Instrucci贸n N掳1",tipo:"Juzgado",email:"juzgado1@example.com",telefono:"+5493755123456",contacto:"Dr. Juan P茅rez",notas:""},
            {nombre:"Municipalidad de Posadas",tipo:"Municipalidad",email:"info@posadas.gov.ar",telefono:"+5493755765432",contacto:"Secretar铆a General",notas:""},
            {nombre:"Organizaci贸n Comunitaria",tipo:"Otro",email:"comunidad@example.com",telefono:"+5493755987654",contacto:"Coordinador",notas:"Organizaci贸n sin fines de lucro"}
        ];

        // ===== Funciones de utilidad =====
        const escapeHtml = (s) => {
            return String(s || '').replace(/[&<>"']/g, m => 
                ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
        };

        const mostrarAlertaFlotante = (mensaje, tipo) => {
            floatingAlert.textContent = mensaje;
            floatingAlert.classList.remove('danger', 'success');
            floatingAlert.classList.add(tipo);
            floatingAlert.classList.add('show');
            setTimeout(() => {
                floatingAlert.classList.remove('show');
            }, 3000);
        };

        // ===== Funciones de m贸dulos =====
        function renderModules() {
            modulesGrid.innerHTML = '';
            
            categories.forEach(category => {
                const count = category.id === 'todos' 
                    ? allOrganisms.length 
                    : category.id === 'otros'
                    ? allOrganisms.filter(o => o.tipo.toLowerCase() === 'otro').length
                    : allOrganisms.filter(o => o.tipo.toLowerCase() === category.name.toLowerCase()).length;
                
                const moduleCard = document.createElement('div');
                moduleCard.className = 'module-card';
                moduleCard.dataset.category = category.id;
                moduleCard.innerHTML = `
                    <div class="module-icon">
                        <i class="fas ${category.icon}"></i>
                    </div>
                    <div class="module-name">${category.name}</div>
                    <div class="module-count">${count} organismos</div>
                `;
                
                moduleCard.onclick = () => selectCategory(category.id);
                modulesGrid.appendChild(moduleCard);
            });
        }

        function selectCategory(categoryId) {
            // Actualizar m贸dulo activo
            document.querySelectorAll('.module-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`.module-card[data-category="${categoryId}"]`).classList.add('active');
            
            currentCategory = categoryId;
            
            // Mostrar secciones
            filtersSection.style.display = 'block';
            tableSection.style.display = 'block';
            $('paginacion-superior').style.display = 'flex';
            $('paginacion-inferior').style.display = 'flex';
            
            // Actualizar t铆tulo de tabla
            const category = categories.find(c => c.id === categoryId);
            tableCategory.textContent = category.name;
            
            // Filtrar organismos
            filtrarOrganismos();
        }

        // ===== Funciones de validaci贸n =====
        function validateForm() {
            let isValid = true;
            const requiredFields = ["nombre", "tipo"];
            
            requiredFields.forEach(id => {
                const field = $(id);
                const parent = field.closest('.form-group');
                if (field.value.trim() === "") {
                    parent.classList.add('error');
                    isValid = false;
                } else {
                    parent.classList.remove('error');
                }
            });

            return isValid;
        }

        // ===== Funciones de paginaci贸n =====
        function actualizarPaginacion() {
            const totalPaginas = Math.ceil(filteredOrganisms.length / registrosPorPagina);
            const inicio = (paginaActual - 1) * registrosPorPagina + 1;
            const fin = Math.min(paginaActual * registrosPorPagina, filteredOrganisms.length);
            const total = filteredOrganisms.length;
            
            // Actualizar informaci贸n de p谩gina
            const pageInfoText = `Mostrando ${inicio}-${fin} de ${total} registros`;
            $("pageInfoTop").textContent = pageInfoText;
            $("pageInfoBottom").textContent = pageInfoText;
            
            // Actualizar selectores de p谩gina
            const pageSelectTop = $("pageSelectTop");
            const pageSelectBottom = $("pageSelectBottom");
            
            pageSelectTop.innerHTML = '';
            pageSelectBottom.innerHTML = '';
            
            for (let i = 1; i <= totalPaginas; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `P谩gina ${i}`;
                if (i === paginaActual) {
                    option.selected = true;
                }
                pageSelectTop.appendChild(option.cloneNode(true));
                pageSelectBottom.appendChild(option);
            }
            
            // Actualizar estado de botones
            const prevButtons = [$("btnPrevPageTop"), $("btnPrevPageBottom")];
            const nextButtons = [$("btnNextPageTop"), $("btnNextPageBottom")];
            
            prevButtons.forEach(btn => {
                btn.disabled = paginaActual === 1;
            });
            
            nextButtons.forEach(btn => {
                btn.disabled = paginaActual === totalPaginas;
            });
            
            // Actualizar contador de tabla
            tableCount.textContent = `Total: ${total}`;
        }

        function cambiarPagina(nuevaPagina) {
            const totalPaginas = Math.ceil(filteredOrganisms.length / registrosPorPagina);
            
            if (nuevaPagina < 1 || nuevaPagina > totalPaginas) {
                return;
            }
            
            paginaActual = nuevaPagina;
            renderTable();
            actualizarPaginacion();
        }

        // ===== Funciones de renderizado =====
        function renderTable() {
            const inicio = (paginaActual - 1) * registrosPorPagina;
            const fin = inicio + registrosPorPagina;
            const organismsToShow = filteredOrganisms.slice(inicio, fin);
            
            tbody.innerHTML = '';
            
            if (organismsToShow.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6">
                            <div class="empty-state">No hay organismos que coincidan con los filtros</div>
                        </td>
                    </tr>`;
                return;
            }
            
            organismsToShow.forEach(organism => {
                const emailLink = organism.email ? 
                    `<a href='mailto:${escapeHtml(organism.email)}'>${escapeHtml(organism.email)}</a>` : 
                    '-';
                
                const telefonoLink = organism.telefono ? 
                    `<a href='tel:${escapeHtml(organism.telefono)}'>${escapeHtml(organism.telefono)}</a>` : 
                    '-';
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${escapeHtml(organism.nombre)}</strong></td>
                    <td><strong>${escapeHtml(organism.tipo)}</strong></td>
                    <td><strong>${emailLink}</strong></td>
                    <td><strong>${telefonoLink}</strong></td>
                    <td><strong>${escapeHtml(organism.contacto || '-')}</strong></td>
                    <td class="actions">
                        <button class="btn-icon btn-view ver-organismo" data-id="${organism.id}" title="Ver organismo">
                            <i class="fa fa-eye"></i>
                        </button>
                        <button class="btn-icon btn-edit editar-organismo" data-id="${organism.id}" title="Editar organismo">
                            <i class="fa fa-pen"></i>
                        </button>
                        <button class="btn-icon btn-print imprimir-organismo" data-id="${organism.id}" title="Imprimir organismo">
                            <i class="fa fa-print"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            // Asignar eventos a los botones
            document.querySelectorAll(".ver-organismo").forEach(btn => {
                btn.onclick = () => abrirVer(btn.dataset.id);
            });
            
            document.querySelectorAll(".editar-organismo").forEach(btn => {
                btn.onclick = () => abrirEditar(btn.dataset.id);
            });
            
            document.querySelectorAll(".imprimir-organismo").forEach(btn => {
                btn.onclick = () => imprimirOrganismoIndividual(btn.dataset.id);
            });
        }

        // ===== Funciones de filtrado =====
        function filtrarOrganismos() {
            const q = (buscador.value || "").toLowerCase();
            const tipo = (filtroTipo.value || "").toLowerCase();
            
            // Filtrar por categor铆a primero
            if (currentCategory === 'todos') {
                filteredOrganisms = allOrganisms;
            } else if (currentCategory === 'otros') {
                filteredOrganisms = allOrganisms.filter(organism => 
                    organism.tipo.toLowerCase() === 'otro'
                );
            } else {
                const category = categories.find(c => c.id === currentCategory);
                filteredOrganisms = allOrganisms.filter(organism => 
                    organism.tipo.toLowerCase() === category.name.toLowerCase()
                );
            }
            
            // Aplicar filtros adicionales
            filteredOrganisms = filteredOrganisms.filter(organism => {
                const okTexto = !q || 
                    organism.nombre.toLowerCase().includes(q) || 
                    organism.tipo.toLowerCase().includes(q) ||
                    (organism.contacto && organism.contacto.toLowerCase().includes(q)) ||
                    (organism.notas && organism.notas.toLowerCase().includes(q));
                
                const okTipo = !tipo || organism.tipo.toLowerCase() === tipo;
                
                return okTexto && okTipo;
            });
            
            // Resetear a la primera p谩gina despu茅s de filtrar
            paginaActual = 1;
            renderTable();
            actualizarPaginacion();
        }

        // ===== Funciones CRUD =====
        function abrirNuevo() {
            editingId = null;
            modalTitle.textContent = "Nuevo Organismo";
            $("organismForm").reset();
            
            // Limpiar errores de validaci贸n
            document.querySelectorAll('.form-group.error').forEach(el => {
                el.classList.remove('error');
            });
            
            modal.style.display = "flex";
        }

        function abrirVer(id) {
            viewingId = id;
            const organism = allOrganisms.find(o => o.id === id);
            if (organism) {
                $("viewModalTitle").textContent = `Ver: ${organism.nombre}`;
                $("viewNombre").textContent = organism.nombre || '-';
                $("viewTipo").textContent = organism.tipo || '-';
                $("viewEmail").textContent = organism.email || '-';
                $("viewTelefono").textContent = organism.telefono || '-';
                $("viewContacto").textContent = organism.contacto || '-';
                $("viewNotas").textContent = organism.notas || '-';
                
                viewModal.style.display = "flex";
            } else {
                mostrarAlertaFlotante("Organismo no encontrado", "danger");
            }
        }

        function abrirEditar(id) {
            editingId = id;
            modalTitle.textContent = "Editar Organismo";
            
            const organism = allOrganisms.find(o => o.id === id);
            if (organism) {
                $("nombre").value = organism.nombre || "";
                $("tipo").value = organism.tipo || "";
                $("email").value = organism.email || "";
                $("telefono").value = organism.telefono || "";
                $("contacto").value = organism.contacto || "";
                $("notas").value = organism.notas || "";
                
                // Limpiar errores de validaci贸n
                document.querySelectorAll('.form-group.error').forEach(el => {
                    el.classList.remove('error');
                });
                
                modal.style.display = "flex";
            } else {
                mostrarAlertaFlotante("Organismo no encontrado", "danger");
            }
        }

        async function guardarOrganismo() {
            if (!validateForm()) {
                mostrarAlertaFlotante("Por favor, completa los campos obligatorios", "danger");
                return;
            }
            
            const datos = {
                nombre: $("nombre").value.trim(),
                tipo: $("tipo").value.trim(),
                email: $("email").value.trim(),
                telefono: $("telefono").value.trim(),
                contacto: $("contacto").value.trim(),
                notas: $("notas").value.trim()
            };
            
            try {
                if (editingId) {
                    await organismsRef.child(editingId).update(datos);
                    mostrarAlertaFlotante("Organismo actualizado correctamente", "success");
                } else {
                    await organismsRef.push(datos);
                    mostrarAlertaFlotante("Organismo creado correctamente", "success");
                }
                
                modal.style.display = "none";
            } catch (error) {
                console.error("Error al guardar organismo:", error);
                mostrarAlertaFlotante("Error al guardar el organismo", "danger");
            }
        }

        // ===== Funciones de impresi贸n =====
        function imprimirModulo() {
            if (!currentCategory) {
                mostrarAlertaFlotante("Selecciona un m贸dulo primero", "danger");
                return;
            }
            
            const category = categories.find(c => c.id === currentCategory);
            let organismsToPrint = [];
            
            if (currentCategory === 'todos') {
                organismsToPrint = allOrganisms;
            } else if (currentCategory === 'otros') {
                organismsToPrint = allOrganisms.filter(o => o.tipo.toLowerCase() === 'otro');
            } else {
                organismsToPrint = allOrganisms.filter(o => o.tipo.toLowerCase() === category.name.toLowerCase());
            }
            
            const head = `
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Tipo</th>
                        <th>Email</th>
                        <th>Tel茅fono</th>
                        <th>Contacto</th>
                        <th>Notas</th>
                    </tr>
                </thead>`;
            
            let body = '<tbody>';
            organismsToPrint.forEach(organism => {
                body += `
                    <tr>
                        <td><strong>${escapeHtml(organism.nombre)}</strong></td>
                        <td><strong>${escapeHtml(organism.tipo)}</strong></td>
                        <td><strong>${escapeHtml(organism.email || '-')}</strong></td>
                        <td><strong>${escapeHtml(organism.telefono || '-')}</strong></td>
                        <td><strong>${escapeHtml(organism.contacto || '-')}</strong></td>
                        <td><strong>${escapeHtml(organism.notas || '-')}</strong></td>
                    </tr>`;
            });
            body += '</tbody>';
            
            const w = window.open("", "_blank", "width=900,height=700");
            w.document.write(`
                <html>
                    <head>
                        <title>${category.name} - Directorio de Organismos</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            h1 { color: #007bff; text-align: center; margin-bottom: 20px; }
                            table { width: 100%; border-collapse: collapse; }
                            th, td { padding: 10px; border-bottom: 1px solid #ddd; text-align: left; }
                            th { background-color: #007bff; color: white; font-weight: bold; }
                            td { font-weight: bold; }
                            tr:nth-child(even) { background-color: #f8f9fa; }
                            .print-date { text-align: right; color: #6c757d; margin-bottom: 20px; }
                        </style>
                    </head>
                    <body>
                        <h1>${category.name} - Directorio de Organismos</h1>
                        <div class="print-date">Impreso el: ${new Date().toLocaleDateString()}</div>
                        <table>${head}${body}</table>
                    </body>
                </html>
            `);
            w.document.close();
            w.focus();
            w.print();
        }

        function imprimirOrganismoIndividual(id) {
            const organism = allOrganisms.find(o => o.id === id);
            if (!organism) {
                mostrarAlertaFlotante("Organismo no encontrado", "danger");
                return;
            }
            
            const w = window.open("", "_blank", "width=600,height=400");
            w.document.write(`
                <html>
                    <head>
                        <title>${organism.nombre} - Directorio de Organismos</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 30px; }
                            h1 { color: #007bff; text-align: center; margin-bottom: 30px; }
                            .organism-card { border: 2px solid #007bff; border-radius: 10px; padding: 20px; max-width: 500px; margin: 0 auto; }
                            .field { margin-bottom: 15px; }
                            .field label { font-weight: bold; color: #007bff; display: block; margin-bottom: 5px; }
                            .field .value { padding: 8px; background: #f8f9fa; border-radius: 5px; font-weight: bold; }
                            .print-date { text-align: right; color: #6c757d; margin-top: 20px; }
                        </style>
                    </head>
                    <body>
                        <h1>Ficha del Organismo</h1>
                        <div class="organism-card">
                            <div class="field">
                                <label>Nombre:</label>
                                <div class="value">${escapeHtml(organism.nombre)}</div>
                            </div>
                            <div class="field">
                                <label>Tipo:</label>
                                <div class="value">${escapeHtml(organism.tipo)}</div>
                            </div>
                            <div class="field">
                                <label>Email:</label>
                                <div class="value">${escapeHtml(organism.email || 'No especificado')}</div>
                            </div>
                            <div class="field">
                                <label>Tel茅fono:</label>
                                <div class="value">${escapeHtml(organism.telefono || 'No especificado')}</div>
                            </div>
                            <div class="field">
                                <label>Contacto:</label>
                                <div class="value">${escapeHtml(organism.contacto || 'No especificado')}</div>
                            </div>
                            <div class="field">
                                <label>Notas:</label>
                                <div class="value">${escapeHtml(organism.notas || 'No hay notas')}</div>
                            </div>
                        </div>
                        <div class="print-date">Impreso el: ${new Date().toLocaleDateString()}</div>
                    </body>
                </html>
            `);
            w.document.close();
            w.focus();
            w.print();
        }

        function printListado() {
            // Crear una copia de la tabla sin la columna de acciones
            const table = tbody.closest("table");
            const head = table.querySelector("thead");
            const headClone = head.cloneNode(true);
            
            // Remover la columna de acciones del encabezado
            const headerRow = headClone.querySelector("tr");
            headerRow.deleteCell(5); // Eliminar la columna de acciones (铆ndice 5)
            
            // Crear cuerpo de la tabla sin acciones
            let body = '<tbody>';
            filteredOrganisms.forEach(organism => {
                const emailLink = organism.email ? 
                    `${escapeHtml(organism.email)}` : 
                    '-';
                
                const telefonoLink = organism.telefono ? 
                    `${escapeHtml(organism.telefono)}` : 
                    '-';
                
                body += `
                    <tr>
                        <td><strong>${escapeHtml(organism.nombre)}</strong></td>
                        <td><strong>${escapeHtml(organism.tipo)}</strong></td>
                        <td><strong>${emailLink}</strong></td>
                        <td><strong>${telefonoLink}</strong></td>
                        <td><strong>${escapeHtml(organism.contacto || '-')}</strong></td>
                    </tr>`;
            });
            body += '</tbody>';
            
            const w = window.open("", "_blank", "width=900,height=700");
            w.document.write(`
                <html>
                    <head>
                        <title>Directorio de Organismos</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            h1 { color: #007bff; text-align: center; margin-bottom: 20px; }
                            table { width: 100%; border-collapse: collapse; }
                            th, td { padding: 10px; border-bottom: 1px solid #ddd; text-align: left; }
                            th { background-color: #007bff; color: white; font-weight: bold; }
                            td { font-weight: bold; }
                            tr:nth-child(even) { background-color: #f8f9fa; }
                            .print-info { text-align: center; color: #6c757d; margin-bottom: 20px; }
                        </style>
                    </head>
                    <body>
                        <h1>Directorio de Organismos</h1>
                        <div class="print-info">
                            <p>Total de organismos: ${filteredOrganisms.length} | Fecha: ${new Date().toLocaleDateString()}</p>
                        </div>
                        <table>${headClone.outerHTML}${body}</table>
                    </body>
                </html>
            `);
            w.document.close();
            w.focus();
            w.print();
        }

        // ===== Inicializaci贸n =====
        function initApp() {
            // Precargar datos iniciales si la base de datos est谩 vac铆a
            organismsRef.once('value', snap => {
                if (!snap.exists()) {
                    initialOrganisms.forEach(organism => {
                        organismsRef.push(organism);
                    });
                }
            });

            // Escuchar cambios en la base de datos
            organismsRef.on('value', snap => {
                const data = snap.val() || {};
                allOrganisms = Object.entries(data).map(([id, value]) => ({
                    id,
                    ...value
                }));
                
                renderModules();
                if (currentCategory) {
                    filtrarOrganismos();
                }
            });

            // Asignar eventos
            $("btnNuevo").onclick = abrirNuevo;
            $("btnPolicia").onclick = () => policiaModal.style.display = "flex";
            $("btnGuardar").onclick = guardarOrganismo;
            $("btnCancelar").onclick = () => modal.style.display = "none";
            $("btnCerrarView").onclick = () => viewModal.style.display = "none";
            $("btnCerrarPolicia").onclick = () => policiaModal.style.display = "none";
            $("btnPrintModule").onclick = imprimirModulo;
            $("btnPrintListado").onclick = printListado;
            $("btnPrintIndividual").onclick = () => imprimirOrganismoIndividual(viewingId);
            
            // Eventos de filtrado
            buscador.oninput = filtrarOrganismos;
            filtroTipo.onchange = filtrarOrganismos;
            
            // Eventos de paginaci贸n superiores
            $("btnPrevPageTop").onclick = () => cambiarPagina(paginaActual - 1);
            $("btnNextPageTop").onclick = () => cambiarPagina(paginaActual + 1);
            $("pageSelectTop").onchange = (e) => cambiarPagina(parseInt(e.target.value));
            
            // Eventos de paginaci贸n inferiores
            $("btnPrevPageBottom").onclick = () => cambiarPagina(paginaActual - 1);
            $("btnNextPageBottom").onclick = () => cambiarPagina(paginaActual + 1);
            $("pageSelectBottom").onchange = (e) => cambiarPagina(parseInt(e.target.value));

            // Cerrar modales al hacer clic fuera
            window.addEventListener("click", e => {
                if (e.target === modal) modal.style.display = "none";
                if (e.target === viewModal) viewModal.style.display = "none";
                if (e.target === policiaModal) policiaModal.style.display = "none";
            });
        }

        // Inicializar la aplicaci贸n cuando el DOM est茅 listo
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            initApp();
        }
    </script>
</body>
</html>
